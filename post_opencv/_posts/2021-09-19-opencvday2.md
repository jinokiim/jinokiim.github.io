---
layout: post
title: OpenCV
subtitle: day2
gh-repo: jinokiim/jinokiim.github.io
gh-badge: [star, fork, follow]
thumbnail-img: /assets/img/opencv/opencvlogo.png
cover-img: /assets/img/opencv/opencvlogo.png
tags: [OpenCV]
comments: true
---

* numpy 설치


```python
# pip install numpy
import numpy

# 버전 확인
numpy.__version__
```




    '1.20.3'



* openCV 설치


```python
# pip install opencv-python
# pip install open-contrib-python
import cv2

# 버전 확인
cv2.__version__
```




    '4.5.3'

if img is not None:
    cv2.imshow('IMG', img)
    cv2.waitKey()
    cv2.destroyAllWindows()
else:
    print('No image file.')
```

### 이미지 저장하기
* 이미지를 그레이 스케일로 저장


```python
import cv2

img_file = './img/girl.jpg'
save_file = './img/girl_gray1.jpg'

img = cv2.imread(img_file, cv2.IMREAD_GRAYSCALE)
cv2.imshow(img_file, img)
cv2.imwrite(save_file, img)     # 파일로 저장, 포맷은 확장자에따라 다름
cv2.waitKey()
cv2.destroyAllWindows()
```

### 코드 해석

##### cv2.imwrite(file_path, img) : 이미지를 파일에 저장
* file_path : 저장할 파일 경로 이름, 문자열
* img : 저장할 영상, numpy 배열

### 동영상 파일 읽기

##### cap = cv2.VideoCapture(file_path 또는 index) : 비디오 캡처 객체 생성자
* file_path : 동영상 파일 경로
* index : 카메라 장치 번호, 0부터 순차적으로 증가
* cap : VideoCapture 객체

##### ret = cap.isOpened( ) : 객체 초기화 확인
* ret : 초기화 여부, True/False

##### ret, img = cap.read( ) : 영상 프레임 읽기
* ret : 프레임 읽기 성공 또는 실패 여부, True/False
* img : 프레임 이미지, numpy 배열 또는 None

##### cap.set( id, value) : 프로퍼티 변경

##### cap.get(id) : 프로퍼티 확인

##### cap.release( ) : 캡처 자원 반납



```python
import cv2

video_file = './img/big_buck.avi'    # 동영상 파일 경로

cap = cv2.VideoCapture(video_file)    # 동영상 캡처 객체 생성
if cap.isOpened():             # 캡처 객체 초기화 확인
    while True:
        ret, img = cap.read()    # 다음 프레임 읽기
        if ret:     # 프레임 읽기 정상이면
            cv2.imshow(video_file, img)    # 화면에 표시
            cv2.waitKey(25)      # 25ms 지연
        else:      # 읽을 수 없으면
            break   # 완료
else:
    print("can't open video")    # 캡처 객체 초기화 실패
cap.release()      # 캡처 자원 반납
cv2.destroyAllWindows()
```

### 카메라(웹캠) 프레임 읽기


```python
import cv2

cap = cv2.VideoCapture(0)     # 0번 카메라 장치 연결
if cap.isOpened():
    while True:
        ret, img = cap.read()   # 카메라 프레임 읽기
        if ret:
            cv2.imshow('camera', img)    # 프레임 이미지 표시
            if cv2.waitKey(1) != -1:     # 1ms 동안 키 입력 대기
                break                 # 아무 키나 눌렀으면 중지
        else:
            print('no frame')
            break
else:
    print("can't open cameera.")
cap.release()
cv2.destroyAllWindows()
```

### 카메라 비디오 속성
cv2.destroyAllWindows()
```
